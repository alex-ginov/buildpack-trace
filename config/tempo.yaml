server:
  http_listen_address: "0.0.0.0"
  # CORRECTION 1: Remplacer ${PORT} par une valeur numérique (3200 est le défaut de Tempo).
  # La surcharge en ligne de commande dans start-tempo prendra le relais de toute façon.
  http_listen_port: 3200 
  log_level: info

# Configuration du distributeur (reçoit les traces OTLP)
distributor:
  receivers:
    otlp:
      protocols:
        # 1. OTLP HTTP : Écoute sur le port public de Scalingo ($PORT)
        # Il est plus sûr d'utiliser une valeur numérique ici aussi pour éviter le plantage YAML.
        http:
          endpoint: "0.0.0.0:3200" # Sera surchargé par le flag OTLP du serveur si le port est partagé

        # 2. OTLP gRPC : Port 4317 interne
        grpc:
          endpoint: "0.0.0.0:4317"

# Configuration du stockage (backend 'local' pour le stockage sur le disque du conteneur)
storage:
  trace:
    backend: local
    wal:
      path: /tmp/tempo-data/wal 
    local:
      path: /tmp/tempo-data/blocks 

# Configuration du compresseur
compactor:
  compaction:
    block_retention: 24h
    compacted_block_retention: 1h

# CORRECTION 2: Le champ 'limits' doit être sous 'overrides' pour Tempo 2.x
overrides:
  limits:
    max_bytes_per_trace: 1000000